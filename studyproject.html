<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zahra Amelia Learning Dashboard â€” Tenses & Study Notes (Home v2)</title>
<style>
  /* ===== General Styles ===== */
  * { box-sizing: border-box; }
  body, html {margin:0;padding:0;font-family:'Inter',sans-serif;background:#f0f2f5;color:#333;overflow-x:hidden; min-width:320px;}
  a{text-decoration:none;color:inherit;}

  /* ===== Intro Splash ===== */
#intro {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #ffffff;
  display: flex;
  flex-direction: row; /* side by side */
  justify-content: center;
  align-items: center;
  gap: 30px; /* space between logo and photo */
  z-index: 10;
  transition: opacity 1s ease;
}
#intro.fade-out {opacity:0;pointer-events:none}
#intro img{width:150px;height:150px;object-fit:cover;border-radius:12px;animation:logo-slide 1s ease forwards}
@keyframes logo-slide{0%{opacity:0;transform:translateY(-20px)}100%{opacity:1;transform:translateY(0)}}
#intro h1{margin:0;font-size:32px;margin-bottom:25px;opacity:0;animation:name-fade 1s forwards 0.5s;color:#4A4A4A}
@keyframes name-fade{to{opacity:1}}
#enter-btn{padding:12px 30px;font-size:16px;border:none;background:linear-gradient(135deg,#4CAF50,#45A049);color:white;cursor:pointer;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);opacity:0;animation:btn-fade 1s forwards 1s;transition:all .3s}
#enter-btn:hover{transform:scale(1.05);box-shadow:0 6px 15px rgba(0,0,0,0.2)}
@keyframes btn-fade{to{opacity:1}}

  /* ===== Navbar ===== */
  #navbar{display:flex;justify-content:space-between;align-items:center;padding:10px 25px;background:#ffffff;box-shadow:0 2px 8px rgba(0,0,0,0.1);position:sticky;top:0;z-index:5}
  #navbar .logo{font-weight:700;font-size:22px;color:#4CAF50;display:flex;align-items:center;gap:12px}
  #navbar nav a{margin-left:14px;font-weight:500;color:#555;transition:color .3s;cursor:pointer}
  #navbar nav a:hover{color:#4CAF50}
  #navbar input[type=text]{padding:6px 12px;width:220px;border:1px solid #ddd;border-radius:8px;transition:all .3s}
  #navbar input[type=text]:focus{outline:none;border-color:#4CAF50;box-shadow:0 0 5px rgba(76,175,80,0.5)}

  /* ===== Main Content ===== */
  #main-content{padding:25px 30px;display:none}
  .section{margin-bottom:40px}
  .section h2{text-align:center;margin-bottom:20px;font-weight:600;font-size:24px;color:#333}
  .card{background:white;padding:18px 20px;margin-bottom:12px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.07);transition:transform .2s,box-shadow .2s}
  .card:hover{transform:translateY(-3px);box-shadow:0 6px 18px rgba(0,0,0,0.1)}
  button{cursor:pointer;border:none;border-radius:8px;transition:all .3s}
  .add-btn{padding:8px 18px;margin-bottom:15px;background:#4CAF50;color:white;font-weight:500;box-shadow:0 3px 10px rgba(0,0,0,0.1)}
  .add-btn:hover{transform:scale(1.05);box-shadow:0 5px 15px rgba(0,0,0,0.15)}

.section{opacity:0;transform:translateY(30px);display:none;animation:section-appear .8s ease forwards}
@keyframes section-appear{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.section.active{display:block;animation:section-appear 1.2s cubic-bezier(.16,1,.3,1) forwards}

  /* ===== Form ===== */
  .form-popup{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#ffffff;padding:25px 30px;box-shadow:0 8px 25px rgba(0,0,0,0.25);border-radius:12px;z-index:20;width:90%;max-width:400px;animation:popup-fade .3s ease}
  @keyframes popup-fade{from{opacity:0;transform:translate(-50%,-48%)}to{opacity:1;transform:translate(-50%,-50%)}}
  .form-popup input,.form-popup textarea{width:100%;padding:10px;margin-bottom:12px;border-radius:8px;border:1px solid #ddd;resize:none;font-size:14px}
  .form-popup textarea{height:80px}
  .form-popup button{padding:10px 18px}
  .save-btn{background:#4CAF50;color:white}
  .save-btn:hover{transform:scale(1.05)}
  .cancel-btn{background:#f44336;color:white}
  .cancel-btn:hover{transform:scale(1.05)}

  .zahra-photo{width:120px;height:120px;object-fit:cover;border-radius:12px;position:relative;z-index:1;box-shadow:0 4px 12px rgba(0,0,0,0.15)}
  .zahra-photo{width:200px;height:200px;object-fit:cover;object-position:top center;border-radius:50%;position:relative;z-index:1;box-shadow:0 4px 12px rgba(0,0,0,0.15)}
  .zahra-photo::after{content:'';position:absolute;top:-4px;left:-4px;width:calc(100% + 8px);height:calc(100% + 8px);background:linear-gradient(135deg,#4CAF50 50%,transparent 50%);border-radius:14px;z-index:-1}

  .logo{width:55px;height:55px;border-radius:50%;overflow:hidden;border:2px solid #ccc;display:flex;align-items:center;justify-content:center;margin-left:15px;margin-top:10px;transition:all .4s}
  .logo img{width:100%;height:100%;object-fit:cover;object-position:center top;transition:transform .4s}
  .logo:hover img{transform:scale(1.08)}

/* ===== Home layout ===== */
.home-grid{display:grid;grid-template-columns:1fr 380px;gap:20px;align-items:start}
@media(max-width:920px){.home-grid{grid-template-columns:1fr;}}
.quick-cards{display:flex;gap:12px;flex-wrap:wrap}
.quick-card{background:white;padding:12px 14px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.04);min-width:140px;flex:1}
.progress-bar{height:12px;background:#e6f4ef;border-radius:8px;overflow:hidden}
.progress-bar > i{display:block;height:100%;background:#4CAF50;width:0%}
.quote-box{background:white;padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.04)}
.small-muted{font-size:13px;color:#666;margin-top:8px}

/* ===== Mini Attendance Calendar ===== */
.calendar-wrapper {
  background: #fff;
  padding: 12px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  margin-bottom: 20px;
  width: 100%;
  max-width: 360px; /* cukup lebar tapi masih responsive */
}

.calendar-wrapper h3 {
  text-align: center;
  margin-bottom: 10px;
  color: #4CAF50;
  font-weight: 600;
  font-size: 16px;
}

.calendar-header {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  text-align: center;
  font-weight: 600;
  font-size: 12px;
  margin-bottom: 6px;
  color: #555;
}

.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 8px;
}

.calendar-grid div {
  padding: 14px 0;
  text-align: center;
  border-radius: 8px;
  background: #f8f8f8;
  font-weight: 500;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 32px;
}

.calendar-grid div:hover {
  background: #d1f0eb;  /* hover lebih jelas */
}

.calendar-grid div.present { background:#4CAF50; color:white; }
.calendar-grid div.absent { background:#f44336; color:white; }

.month-wrapper {
  display: flex;
  gap: 20px;
  margin-bottom: 30px;
  flex-wrap: wrap; /* biar responsive di HP */
  padding-left: 15px; /* tambahkan ini supaya kalender ga nempel ke kiri */
}

.notes-wrapper {
  flex: 1; /* ambil sisa space di kanan */
  min-width: 200px;
}

/* Animasi untuk calendar dan notes saat section active */
.calendar-wrapper,
.notes-wrapper {
  position: relative; /* supaya pseudo-element bisa diposisikan */
  overflow: hidden;
}

.calendar-wrapper::before,
.notes-wrapper::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(76, 175, 80, 0.05); /* highlight lembut */
  transform: scaleY(0);
  transform-origin: top;
  transition: transform 0.5s ease;
  pointer-events: none;
}

.section.active .calendar-wrapper::before,
.section.active .notes-wrapper::before {
  transform: scaleY(1); /* animasi muncul */
}



  /* ===== Sidebar for Semester ===== */
  .doa-wrap{display:flex;gap:18px;align-items:flex-start}
  .sidebar{min-width:160px;background:linear-gradient(180deg,#eef2f7,#ffffff);border-radius:12px;padding:10px;display:flex;flex-direction:column;gap:8px}
  .side-tab{padding:10px;border-radius:10px;text-align:center;font-weight:600;cursor:pointer;color:#475569;background:transparent}
  .side-tab.active{background:#4CAF50;color:#fff}
  .doa-content{flex:1;background:white;border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(2,6,23,0.04)}

  @media (max-width:720px){
    .doa-wrap{flex-direction:column}
    .sidebar{width:100%;display:flex;flex-direction:row;gap:8px;overflow:auto;padding:8px}
    .side-tab{text-align:center;white-space:nowrap;flex:0 0 auto}
  }

  .sub-tabs { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap;}
  .sub-tab { padding: 6px 14px; border-radius: 8px; background: #f0f2f5; border: none; font-weight: 600; cursor: pointer; transition: all 0.2s;}
  .sub-tab.active { background: #4CAF50; color: white;}

  /* Vocabulary grid layout */
  #vocab-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; margin-top: 12px;}
  #vocab-list .card { display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; gap: 8px; padding: 12px 20px; min-height: 60px; background: white; border-radius: 10px; box-shadow: 0 6px 18px rgba(2,6,23,0.06); transition: transform 0.18s, box-shadow 0.18s; cursor: pointer;}
  /* Animasi untuk setiap elemen di Attendance */
#attendance .month-wrapper {
  opacity: 0;
  transform: translateY(20px);
  animation: month-appear 0.6s forwards;
}

#attendance .month-wrapper:nth-child(1) { animation-delay: 0.1s; }
#attendance .month-wrapper:nth-child(2) { animation-delay: 0.3s; }
#attendance .month-wrapper:nth-child(3) { animation-delay: 0.5s; }
#attendance .month-wrapper:nth-child(4) { animation-delay: 0.7s; }
#attendance .month-wrapper:nth-child(5) { animation-delay: 0.9s; }

@keyframes month-appear {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Animasi untuk card di notes */
#attendance .notes-wrapper .card,
#attendance .notes-wrapper .add-btn {
  opacity: 0;
  transform: translateY(10px);
  animation: card-appear 0.4s forwards;
}

#attendance .notes-wrapper .card:nth-child(1) { animation-delay: 0.2s; }
#attendance .notes-wrapper .card:nth-child(2) { animation-delay: 0.4s; }
#attendance .notes-wrapper .card:nth-child(3) { animation-delay: 0.6s; }
/* dst, nanti JS bisa tambahkan delay dinamis jika banyak card */

@keyframes card-appear {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* small helper: study-notes card styling */
#study-notes-list .card { margin-top: 8px; }
</style>
</head>
<body>

<!-- ===== Intro Splash ===== -->
<div id="intro">
  <img src="https://raw.githubusercontent.com/Zahraameliaa33/My-Study-Project/main/Logo_UIN.jpeg" alt="Logo_UIN">
  <img src="https://raw.githubusercontent.com/Zahraameliaa33/My-Study-Project/main/foto_Zahra.jpg" alt="Foto Zahra">

  <h1>Zahra Amelia Fam <br> NIM:1251040158</h1>
  <button id="enter-btn">Enter</button>
</div>

<!-- ===== Navbar ===== -->
<div id="navbar">
  <div class="logo">
    <img src="https://raw.githubusercontent.com/Zahraameliaa33/My-Study-Project/main/foto_Zahra_copy.jpg" alt="Foto Zahra">

    <div>ZA Panel</div>
  </div>
  <nav>
    <a onclick="showSection('home')">Home</a>
    <a onclick="showSection('vocabulary')">Vocabulary</a>
    <a onclick="showSection('semester')">Semester</a>
    <a onclick="showSection('tenses')">Tenses</a>
    <a onclick="showSection('study-notes')">Study Notes</a>
    <a onclick="showSection('attendance')">Attendance</a>
  </nav>
  <input type="text" id="search-input" placeholder="Search notes or vocab">
  <button onclick="searchEntries()" style="padding:6px 12px;margin-left:6px;background:#4CAF50;color:white;border:none;border-radius:6px;cursor:pointer">Search</button>
</div>

<!-- ===== Main Content ===== -->
<div id="main-content">

  <!-- Home Section (upgraded) -->
  <div id="home" class="section">
    <h2>Home â€” Command Center</h2>
    <div class="home-grid">
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:14px;">
          <div>
            <div style="font-size:18px;font-weight:700">As-salamu 'alaykum, Zahra</div>
            <div id="home-date" class="small-muted"></div>
          </div>
          <div style="text-align:right">
            <div style="font-weight:700">Study Streak</div>
            <div id="study-streak" style="font-size:18px;color:#4CAF50;font-weight:700">0 days</div>
          </div>
        </div>

        <div class="quick-cards">
          <div class="quick-card">
            <div style="font-weight:700">Total Vocabulary</div>
            <div id="home-vocab" style="font-size:20px;margin-top:6px">0</div>
            <div class="small-muted">Words & short notes</div>
          </div>

          <div class="quick-card">
            <div style="font-weight:700">Tenses Notes</div>
            <div id="home-tenses" style="font-size:20px;margin-top:6px">0</div>
            <div class="small-muted">All tense sub-notes</div>
          </div>

          <div class="quick-card">
            <div style="font-weight:700">Semester Notes</div>
            <div id="home-semester" style="font-size:20px;margin-top:6px">0</div>
            <div class="small-muted">Course notes & lists</div>
          </div>

          <div class="quick-card">
            <div style="font-weight:700">Study Goal (week)</div>
            <div id="home-progress-count" style="font-size:20px;margin-top:6px">0/5</div>
            <div class="small-muted">Notes towards weekly goal</div>
            <div style="margin-top:8px" class="progress-bar"><i id="home-progress-fill"></i></div>
          </div>
        </div>

        <div style="margin-top:18px" class="quote-box">
          <div id="home-quote" style="font-weight:600">"Time is your capital spend it with intention."</div>
          <div class="small-muted">Daily reminder</div>
        </div>

        <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
          <button class="add-btn" onclick="showSection('vocabulary')">Open Vocabulary</button>
          <button class="add-btn" onclick="showSection('tenses')">Open Tenses</button>
          <button class="add-btn" onclick="showSection('semester')">Open Semester</button>
          <button class="add-btn" onclick="showSection('study-notes')">Study Notes</button>
        </div>

      </div>

      <aside>
        <div class="card" style="margin-bottom:12px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 style="margin:0">Faith Reminder</h3>
            <div class="small-muted">Today</div>
          </div>
          <p id="faith-reminder" style="margin-top:10px;font-size:15px">"And say: My Lord, increase me in knowledge." â€” Qur'an (20:114)</p>
        </div>

        <div class="card">
          <h3 style="margin:0 0 8px 0">Quick Stats</h3>
          <div class="small-muted">Last updated</div>
          <div id="home-last-updated" style="font-weight:700;margin-top:6px">â€”</div>
        </div>
      </aside>
    </div>
  </div>

 <!-- ===== Vocabulary Section ===== -->
<div id="vocabulary" class="section">
  <h2>Vocabulary</h2>
  <button class="add-btn" onclick="openForm('vocabulary')">+ Add New Word</button>
  <div id="vocab-list"></div>
</div>

  <!-- Semester Section -->
  <div id="semester" class="section">
    <h2>Semester</h2>
    <div class="doa-wrap">
      <nav class="sidebar" id="semesterSidebar">
        <div class="side-tab active" data-side="semester1-content">Semester 1</div>
        <div class="side-tab" data-side="semester2">Semester 2</div>
        <div class="side-tab" data-side="semester3">Semester 3</div>
        <div class="side-tab" data-side="semester4">Semester 4</div>
      </nav>

      <div class="doa-content" id="semesterContent">
        <div id="semester1-content" class="side-content">
          <div class="sub-tabs">
            <button class="sub-tab active" data-sub="iip">IIP</button>
            <button class="sub-tab" data-sub="reading">Reading</button>
            <button class="sub-tab" data-sub="bindo">B.Indo</button>
            <button class="sub-tab" data-sub="barab">B.Arab</button>
            <button class="sub-tab" data-sub="speaking">Speaking</button>
            <button class="sub-tab" data-sub="listening">Listening (LDC)</button>
            <button class="sub-tab" data-sub="grammar">Basic Grammar</button>
          </div>

          <div id="iip" class="sub-content" style="display:block;">
            <button class="add-btn" onclick="openForm('semester1-iip')">+ Add Note</button>
            <div id="list-semester1-iip"></div>
          </div>
          <div id="reading" class="sub-content" style="display:none;">
            <button class="add-btn" onclick="openForm('semester1-reading')">+ Add Note</button>
            <div id="list-semester1-reading"></div>
          </div>
          <div id="bindo" class="sub-content" style="display:none;">
            <button class="add-btn" onclick="openForm('semester1-bindo')">+ Add Note</button>
            <div id="list-semester1-bindo"></div>
          </div>
          <div id="barab" class="sub-content" style="display:none;">
            <button class="add-btn" onclick="openForm('semester1-barab')">+ Add Note</button>
            <div id="list-semester1-barab"></div>
          </div>
          <div id="speaking" class="sub-content" style="display:none;">
            <button class="add-btn" onclick="openForm('semester1-speaking')">+ Add Note</button>
            <div id="list-semester1-speaking"></div>
          </div>
          <div id="listening" class="sub-content" style="display:none;">
            <button class="add-btn" onclick="openForm('semester1-listening')">+ Add Note</button>
            <div id="list-semester1-listening"></div>
          </div>
          <div id="grammar" class="sub-content" style="display:none;">
            <button class="add-btn" onclick="openForm('semester1-grammar')">+ Add Note</button>
            <div id="list-semester1-grammar"></div>
          </div>
        </div>

        <div id="semester2" class="side-content" style="display:none">
          <button class="add-btn" onclick="openForm('semester2')">+ Add Note</button>
          <div id="list-semester2"></div>
        </div>
        <div id="semester3" class="side-content" style="display:none">
          <button class="add-btn" onclick="openForm('semester3')">+ Add Note</button>
          <div id="list-semester3"></div>
        </div>
        <div id="semester4" class="side-content" style="display:none">
          <button class="add-btn" onclick="openForm('semester4')">+ Add Note</button>
          <div id="list-semester4"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Tenses Section (UPDATED) ===== -->
  <div id="tenses" class="section">
    <h2>Tenses</h2>
    <div class="doa-wrap">
      <nav class="sidebar" id="tensesSidebar">
        <div class="side-tab active" data-side="present-content">Present</div>
        <div class="side-tab" data-side="past-content">Past</div>
        <div class="side-tab" data-side="future-content">Future</div>
      </nav>

      <div class="doa-content" id="tensesContent">
        <!-- Present -->
        <div id="present-content" class="side-content">
          <div class="sub-tabs">
            <button class="sub-tab active" data-sub="present-simple">Simple Present</button>
            <button class="sub-tab" data-sub="present-cont">Present Continuous</button>
            <button class="sub-tab" data-sub="present-perfect">Present Perfect</button>
            <button class="sub-tab" data-sub="present-perfect-cont">Present Perf. Continuous</button>
          </div>

          <div id="present-simple" class="sub-content" style="display:block;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Simple Present</h3>
                <button class="add-btn" onclick="openForm('tenses-present-simple')">+ Add Note</button>
              </div>
              <div id="list-tenses-present-simple"></div>
            </div>
          </div>

          <div id="present-cont" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Present Continuous</h3>
                <button class="add-btn" onclick="openForm('tenses-present-cont')">+ Add Note</button>
              </div>
              <div id="list-tenses-present-cont"></div>
            </div>
          </div>

          <div id="present-perfect" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Present Perfect</h3>
                <button class="add-btn" onclick="openForm('tenses-present-perfect')">+ Add Note</button>
              </div>
              <div id="list-tenses-present-perfect"></div>
            </div>
          </div>

          <div id="present-perfect-cont" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Present Perfect Continuous</h3>
                <button class="add-btn" onclick="openForm('tenses-present-perfect-cont')">+ Add Note</button>
              </div>
              <div id="list-tenses-present-perfect-cont"></div>
            </div>
          </div>

        </div>

        <!-- Past -->
        <div id="past-content" class="side-content" style="display:none;">
          <div class="sub-tabs">
            <button class="sub-tab active" data-sub="past-simple">Simple Past</button>
            <button class="sub-tab" data-sub="past-cont">Past Continuous</button>
            <button class="sub-tab" data-sub="past-perfect">Past Perfect</button>
            <button class="sub-tab" data-sub="past-perfect-cont">Past Perf. Continuous</button>
          </div>

          <div id="past-simple" class="sub-content" style="display:block;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Simple Past</h3>
                <button class="add-btn" onclick="openForm('tenses-past-simple')">+ Add Note</button>
              </div>
              <div id="list-tenses-past-simple"></div>
            </div>
          </div>

          <div id="past-cont" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Past Continuous</h3>
                <button class="add-btn" onclick="openForm('tenses-past-cont')">+ Add Note</button>
              </div>
              <div id="list-tenses-past-cont"></div>
            </div>
          </div>

          <div id="past-perfect" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Past Perfect</h3>
                <button class="add-btn" onclick="openForm('tenses-past-perfect')">+ Add Note</button>
              </div>
              <div id="list-tenses-past-perfect"></div>
            </div>
          </div>

          <div id="past-perfect-cont" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Past Perfect Continuous</h3>
                <button class="add-btn" onclick="openForm('tenses-past-perfect-cont')">+ Add Note</button>
              </div>
              <div id="list-tenses-past-perfect-cont"></div>
            </div>
          </div>

        </div>

        <!-- Future -->
        <div id="future-content" class="side-content" style="display:none;">
          <div class="sub-tabs">
            <button class="sub-tab active" data-sub="future-simple">Simple Future</button>
            <button class="sub-tab" data-sub="future-cont">Future Continuous</button>
            <button class="sub-tab" data-sub="future-perfect">Future Perfect</button>
            <button class="sub-tab" data-sub="future-perfect-cont">Future Perf. Continuous</button>
          </div>

          <div id="future-simple" class="sub-content" style="display:block;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Simple Future</h3>
                <button class="add-btn" onclick="openForm('tenses-future-simple')">+ Add Note</button>
              </div>
              <div id="list-tenses-future-simple"></div>
            </div>
          </div>

          <div id="future-cont" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Future Continuous</h3>
                <button class="add-btn" onclick="openForm('tenses-future-cont')">+ Add Note</button>
              </div>
              <div id="list-tenses-future-cont"></div>
            </div>
          </div>

          <div id="future-perfect" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Future Perfect</h3>
                <button class="add-btn" onclick="openForm('tenses-future-perfect')">+ Add Note</button>
              </div>
              <div id="list-tenses-future-perfect"></div>
            </div>
          </div>

          <div id="future-perfect-cont" class="sub-content" style="display:none;">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                <h3>Future Perfect Continuous</h3>
                <button class="add-btn" onclick="openForm('tenses-future-perfect-cont')">+ Add Note</button>
              </div>
              <div id="list-tenses-future-perfect-cont"></div>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>

  <!-- Study Notes Section -->
  <div id="study-notes" class="section">
    <h2>Study Notes</h2>
    <button class="add-btn" onclick="openForm('study-notes')">+ Add Note</button>
    <div id="study-notes-list"></div>
  </div>

</div>

  <!-- ===== Attendance Section ===== -->
<div id="attendance" class="section">
  <h2>Attendance</h2>

  <div class="month-wrapper">
    <div class="calendar-wrapper" id="calendar-august"></div>
    <div class="notes-wrapper" id="notes-august"></div>
  </div>

  <div class="month-wrapper">
    <div class="calendar-wrapper" id="calendar-september"></div>
    <div class="notes-wrapper" id="notes-september"></div>
  </div>

  <div class="month-wrapper">
    <div class="calendar-wrapper" id="calendar-october"></div>
    <div class="notes-wrapper" id="notes-october"></div>
  </div>

  <div class="month-wrapper">
    <div class="calendar-wrapper" id="calendar-november"></div>
    <div class="notes-wrapper" id="notes-november"></div>
  </div>

  <div class="month-wrapper">
    <div class="calendar-wrapper" id="calendar-december"></div>
    <div class="notes-wrapper" id="notes-december"></div>
  </div>
</div>

<!-- ===== Form Popup ===== -->
<div id="form-popup" class="form-popup">
  <h3 id="form-title"></h3>
  <input type="text" id="input-title" placeholder="Title / Word">
  <textarea id="input-content" placeholder="Meaning / Note"></textarea>
  <button class="save-btn" onclick="saveEntry()">Save</button>
  <button class="cancel-btn" onclick="closeForm()">Cancel</button>
</div>

<script>
/* =========================
   Unified, robust script
   - fixes study-notes + vocab add/show
   - fixes tenses & semester sub-tabs
   - preserves your markup and IDs
   ========================= */

const intro = document.getElementById('intro');
const mainContent = document.getElementById('main-content');
const enterBtn = document.getElementById('enter-btn');
if (enterBtn) {
  enterBtn.addEventListener('click', () => {
    intro.classList.add('fade-out');
    // hide intro after fade completes and reveal main content
    setTimeout(()=>{
      intro.style.display = 'none';
      mainContent.style.display='block';
      showSection('home');
    }, 1000);
  });
}

// Single, reliable showSection used by navbar onclick attributes
function showSection(id) {
  const sections = ['home','vocabulary','semester','attendance','study-notes','tenses'];
  sections.forEach(sec => {
    const el = document.getElementById(sec);
    if (!el) return;
    if (sec === id) {
      el.style.display = 'block';
      setTimeout(() => {
        el.classList.add('active');
        // reset attendance month animations when showing attendance
        if (sec === 'attendance') {
          const months = el.querySelectorAll('.month-wrapper');
          months.forEach(m => {
            m.style.opacity = 0;
            m.style.transform = 'translateY(20px)';
          });
          setTimeout(() => months.forEach(m => m.style.animationPlayState = 'running'), 50);
        }
      }, 20);
    } else {
      el.classList.remove('active');
      setTimeout(() => el.style.display = 'none', 400);
    }
  });
}

// Ensure initial view (main-content may still be hidden until user clicks enter)
showSection('home');

// Semester sidebar tabs (already matched to HTML)
const semesterTabs = document.querySelectorAll('#semesterSidebar .side-tab');
semesterTabs.forEach(tab => {
  tab.addEventListener('click', () => {
    semesterTabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    // hide all semester side-content
    document.querySelectorAll('#semesterContent .side-content').forEach(c => c.style.display='none');

    const target = tab.getAttribute('data-side');
    const el = document.getElementById(target);
    if (el) el.style.display = 'block';
  });
});

// Tenses sidebar tabs
const tensesTabs = document.querySelectorAll('#tensesSidebar .side-tab');
tensesTabs.forEach(tab => {
  tab.addEventListener('click', () => {
    tensesTabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    // hide all tenses side-content
    document.querySelectorAll('#tensesContent .side-content').forEach(c => c.style.display='none');

    const target = tab.getAttribute('data-side');
    const el = document.getElementById(target);
    if (el) el.style.display = 'block';
  });
});

let currentSection = '';
  let currentEditIndex = null;

  function openForm(section){
    currentSection = section;
    document.getElementById('form-title').innerText = 'Add Note';
    document.getElementById('input-title').value='';
    document.getElementById('input-content').value='';
    document.getElementById('form-popup').style.display='block';
  }

  function closeForm(){
    document.getElementById('form-popup').style.display='none';
  }

  function saveEntry() {
    const title = document.getElementById('input-title').value.trim();
    const content = document.getElementById('input-content').value.trim();
    if (!title || !content) return alert('Fill all fields');

    let list = JSON.parse(localStorage.getItem(currentSection)) || [];

    if (typeof currentEditIndex === 'number') {
      list[currentEditIndex] = { title, content };
      currentEditIndex = null;
    } else {
      list.push({ title, content });
    }

    localStorage.setItem(currentSection, JSON.stringify(list));
    closeForm();

    // Kalau currentSection termasuk bulan, pakai renderMonthNotes
    if(['august','september','october','november','december'].includes(currentSection)){
        renderMonthNotes(currentSection);
    } else {
        renderList(currentSection);
    }
}


  function renderList(section){
    const container = document.getElementById(
      section==='vocabulary'?'vocab-list':'list-' + section
    );
    if(!container) return;
    container.innerHTML='';
    let list = JSON.parse(localStorage.getItem(section)) || [];
    list.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <strong>${item.title}</strong>
        <p>${item.content}</p>
        <div style="display:flex;gap:6px;">
          <button style="background:#f44336; color:white; border:none; border-radius:6px; padding:4px 10px; cursor:pointer;" onclick="deleteEntry('${section}', ${index})">Delete</button>
          <button style="background:#4CAF50; color:white; border:none; border-radius:6px; padding:4px 10px; cursor:pointer;" onclick="editEntry('${section}', ${index})">Edit</button>
        </div>
      `;
      container.appendChild(div);
    });
  }

  function deleteEntry(key,index){
  let list = JSON.parse(localStorage.getItem(key)) || [];
  list.splice(index,1);
  localStorage.setItem(key, JSON.stringify(list));

  if(['august','september','october','november','december'].includes(key)){
      renderMonthNotes(key);
  } else {
      renderList(key);
  }
}

function editEntry(section, index) {
  const list = JSON.parse(localStorage.getItem(section)) || [];
  const item = list[index];
  currentSection = section;
  currentEditIndex = index;
  document.getElementById('form-title').innerText = 'Edit Note';
  document.getElementById('input-title').value = item.title;
  document.getElementById('input-content').value = item.content;
  document.getElementById('form-popup').style.display = 'block';
}


  renderList('vocabulary');

// Helper to update activity log + home stats
function logActivity(action, key) {
  try {
    const log = JSON.parse(localStorage.getItem('activityLog') || '[]');
    log.push({ action, key, ts: new Date().toISOString() });
    localStorage.setItem('activityLog', JSON.stringify(log));
    if (typeof updateHomeStats === 'function') updateHomeStats();
  } catch(e){}
}

// Make a best-effort to find the DOM container for a section key.
// Your HTML uses these naming patterns:
//  vocabulary -> #vocab-list
//  study-notes -> #study-notes-list
//  other sections -> #list-<section>  (eg. #list-semester1-iip, #list-tenses-present-simple)
function getContainerIdFor(section) {
  if (section === 'vocabulary') return 'vocab-list';
  if (section === 'study-notes') return 'study-notes-list';
  // fallback to the standard pattern:
  return 'list-' + section;
}

// Ensure the UI shows the correct sub-content/sub-tab when we render a list
function ensureSubContentVisibleFor(section) {
  // tenses: "tenses-present-simple" -> sub-content id is "present-simple"
  if (section.startsWith('tenses-')) {
    const subId = section.slice('tenses-'.length); // e.g. "present-simple"
    const subEl = document.getElementById(subId);
    if (subEl) {
      // find the sub-tabs container and set correct active tab
      const subTabsParent = subEl.parentElement ? subEl.parentElement.querySelector('.sub-tabs') : null;
      if (subTabsParent) {
        subTabsParent.querySelectorAll('.sub-tab').forEach(b => b.classList.remove('active'));
        const tabBtn = subTabsParent.querySelector(`.sub-tab[data-sub="${subId}"]`);
        if (tabBtn) tabBtn.classList.add('active');
      }
      // show the sub-content
      subEl.style.display = 'block';
      // also ensure the outer present/past/future side-content is visible
      const outer = subEl.closest('.side-content');
      if (outer) outer.style.display = 'block';
    }
  }

  // semester: "semester1-iip" -> parent side-content id "semester1-content" and sub-content id "iip"
  if (section.startsWith('semester')) {
    const parts = section.split('-'); // ["semester1","iip"]
    if (parts.length >= 2) {
      const parentId = parts[0] + '-content'; // "semester1-content"
      const subId = parts.slice(1).join('-'); // "iip"
      const parent = document.getElementById(parentId);
      if (parent) parent.style.display = 'block';
      const subEl = document.getElementById(subId);
      if (subEl) {
        // activate the correct sub-tab
        const subTabsParent = subEl.parentElement ? subEl.parentElement.querySelector('.sub-tabs') : null;
        if (subTabsParent) {
          subTabsParent.querySelectorAll('.sub-tab').forEach(b => b.classList.remove('active'));
          const tabBtn = subTabsParent.querySelector(`.sub-tab[data-sub="${subId}"]`);
          if (tabBtn) tabBtn.classList.add('active');
        }
        subEl.style.display = 'block';
      }
    }
  }
}

function saveEntry() {
  const title = document.getElementById('input-title').value.trim();
  const content = document.getElementById('input-content').value.trim();
  if (!title || !content) return alert('Fill all fields');

  let list = JSON.parse(localStorage.getItem(currentSection) || '[]');

  if (typeof currentEditIndex === 'number') {
    list[currentEditIndex] = { title, content };
    currentEditIndex = null;
    logActivity('edit', currentSection);
  } else {
    list.push({ title, content });
    logActivity('add', currentSection);
  }

  localStorage.setItem(currentSection, JSON.stringify(list));
  closeForm();

  // Update UI: month notes vs normal lists
  if (['august','september','october','november','december'].includes(currentSection)){
    // month notes UI
    if (typeof renderMonthNotes === 'function') renderMonthNotes(currentSection);
  } else {
    renderList(currentSection);
  }

  // update home stats if present
  if (typeof updateHomeStats === 'function') updateHomeStats();
}

// renderList: robustly find container and render items. Also ensures sub-content is visible for tenses/semester.
function renderList(section) {
  const containerId = getContainerIdFor(section);
  let container = document.getElementById(containerId);

  // fallback attempt: sometimes your HTML might use slightly different naming,
  // try alternative pattern "<section>-list"
  if (!container) container = document.getElementById(section + '-list');

  if (!container) {
    // if still not found, bail gracefully (do not throw). Useful during init when some sections absent.
    return;
  }

  // Ensure the relevant sub-content is visible (for tenses / semester)
  ensureSubContentVisibleFor(section);

  container.innerHTML = '';
  const list = JSON.parse(localStorage.getItem(section) || '[]');

  list.forEach((item, index) => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `\n      <strong>${escapeHtml(item.title)}</strong>\n      <p>${escapeHtml(item.content)}</p>\n      <div style="display:flex;gap:6px;margin-top:6px;">\n        <button style="background:#f44336; color:white; border:none; border-radius:6px; padding:4px 10px; cursor:pointer;" onclick="deleteEntry('${section}', ${index})">Delete</button>\n        <button style="background:#4CAF50; color:white; border:none; border-radius:6px; padding:4px 10px; cursor:pointer;" onclick="editEntry('${section}', ${index})">Edit</button>\n      </div>\n    `;
    container.appendChild(div);
  });
}

// simple escaping helper to avoid accidental HTML injection when rendering user data
function escapeHtml(str) {
  if (typeof str !== 'string') return '';
  return str.replace(/[&<>"']/g, function(m) {
    return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]);
  });
}

function deleteEntry(key,index){
  let list = JSON.parse(localStorage.getItem(key) || '[]');
  if (index < 0 || index >= list.length) return;
  list.splice(index,1);
  localStorage.setItem(key, JSON.stringify(list));
  logActivity('delete', key);

  if(['august','september','october','november','december'].includes(key)){
      if (typeof renderMonthNotes === 'function') renderMonthNotes(key);
  } else {
      renderList(key);
  }

  if (typeof updateHomeStats === 'function') updateHomeStats();
}

function editEntry(section, index) {
  const list = JSON.parse(localStorage.getItem(section) || '[]');
  const item = list[index];
  if (!item) return alert('Item not found');
  currentSection = section;
  currentEditIndex = index;
  document.getElementById('form-title').innerText = 'Edit Note';
  document.getElementById('input-title').value = item.title;
  document.getElementById('input-content').value = item.content;
  document.getElementById('form-popup').style.display = 'block';
}

/* =========================
   Initial render calls
   - render vocab & study-notes and the tenses + semester lists (if any saved)
   ========================= */

renderList('vocabulary');
renderList('study-notes');

const tensesInitKeys = [
  'tenses-present-simple','tenses-present-cont','tenses-present-perfect','tenses-present-perfect-cont',
  'tenses-past-simple','tenses-past-cont','tenses-past-perfect','tenses-past-perfect-cont',
  'tenses-future-simple','tenses-future-cont','tenses-future-perfect','tenses-future-perfect-cont'
];
tensesInitKeys.forEach(renderList);

[
  'semester1-iip','semester1-reading','semester1-bindo','semester1-barab','semester1-speaking','semester1-listening','semester1-grammar',
  'semester2','semester3','semester4'
].forEach(renderList);

/* =========================
   Sub-tab wiring
   - makes "IIP, Reading, B.Indo..." and tenses sub-tabs clickable
   ========================= */
function wireSubTabs() {
  const subTabs = document.querySelectorAll('.sub-tab');
  subTabs.forEach(btn => {
    // avoid double-binding by removing existing listener marker
    if (btn.__wired) return;
    btn.__wired = true;

    btn.addEventListener('click', () => {
      const parent = btn.closest('.sub-tabs');
      if (!parent) return;
      parent.querySelectorAll('.sub-tab').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // hide sibling .sub-content elements under the closest side-content container
      const container = parent.closest('.side-content') || parent.parentElement;
      if (!container) return;
      container.querySelectorAll('.sub-content').forEach(c => c.style.display='none');

      const id = btn.getAttribute('data-sub');
      const el = document.getElementById(id);
      if (el) el.style.display = 'block';
    });
  });
}

// call once (script placed at end of body so DOM exists)
wireSubTabs();

/* =========================
   Search functionality (works with vocab, study-notes, semester lists)
   ========================= */

function searchEntries() {
  const query = (document.getElementById('search-input')?.value || '').toLowerCase();
  const sections = ['vocabulary','study-notes','semester1-iip','semester1-reading','semester1-bindo','semester1-barab','semester1-speaking','semester1-listening','semester1-grammar','semester2','semester3','semester4'];
  sections.forEach(section => {
    const containerId = getContainerIdFor(section);
    const container = document.getElementById(containerId);
    if (!container) return;
    const list = JSON.parse(localStorage.getItem(section) || '[]');
    container.innerHTML = '';
    list.filter(item => (item.title || '').toLowerCase().includes(query) || (item.content || '').toLowerCase().includes(query))
      .forEach(item => {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `<strong>${escapeHtml(item.title)}</strong><p>${escapeHtml(item.content)}</p>`;
        container.appendChild(div);
      });
  });
}

/* =========================
   Create search bar for sub sections (non-destructive)
   ========================= */
function createSearchBar(sub) {
  const container = document.getElementById('list-' + sub);
  if (!container) return;
  // Avoid multiple bars
  if (container._hasSearchBar) return;
  container._hasSearchBar = true;

  const searchBar = document.createElement('input');
  searchBar.type = 'text';
  searchBar.placeholder = 'Search note...';
  searchBar.style.cssText = 'width:100%;padding:8px;border-radius:6px;border:1px solid #ccc;margin-bottom:10px;';

  searchBar.addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const list = JSON.parse(localStorage.getItem(sub) || '[]');
    container.innerHTML = '';
    list.forEach((item, index) => {
      if ((item.title || '').toLowerCase().includes(query) || (item.content || '').toLowerCase().includes(query)) {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <strong>${escapeHtml(item.title)}</strong>
          <p>${escapeHtml(item.content)}</p>
          <div style="display:flex;gap:6px;">
            <button style="background:#f44336;color:white;border:none;border-radius:6px;padding:4px 10px;cursor:pointer;" onclick="deleteEntry('${sub}', ${index})">Delete</button>
            <button style="background:#4CAF50;color:white;border:none;border-radius:6px;padding:4px 10px;cursor:pointer;" onclick="editEntry('${sub}', ${index})">Edit</button>
          </div>
        `;
        container.appendChild(div);
      }
    });
  });

  const parent = container.parentElement;
  if (!parent) return;
  // find the Add Note button that uses openForm(...) and insert after it (safe fallback)
  const addNoteBtn = parent.querySelector('button[onclick*="openForm"]');
  if (addNoteBtn) addNoteBtn.insertAdjacentElement('afterend', searchBar);
  else parent.insertBefore(searchBar, container);
}

/* =========================
   Attendance and month notes rendering (unchanged logic, but guarded)
   ========================= */

function renderMonthCalendar(containerId, year, month, monthName) {
  const calendar = document.getElementById(containerId);
  if (!calendar) return;

  const daysInMonth = new Date(year, month + 1, 0).getDate();
  const firstDay = new Date(year, month, 1).getDay();
  const stored = JSON.parse(localStorage.getItem("attendance") || '{}');
  const days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

  calendar.innerHTML = "";

  const title = document.createElement("h3");
  title.textContent = monthName + " " + year;
  title.style.textAlign = "center";
  title.style.marginBottom = "10px";
  title.style.color = "#4CAF50";
  title.style.fontWeight = "600";
  calendar.appendChild(title);

  const header = document.createElement("div");
  header.className = "calendar-header";
  days.forEach(d => {
    const dayDiv = document.createElement("div");
    dayDiv.textContent = d;
    header.appendChild(dayDiv);
  });
  calendar.appendChild(header);

  const grid = document.createElement("div");
  grid.className = "calendar-grid";
  grid.style.gridTemplateColumns = "repeat(7,1fr)";
  grid.style.marginBottom = "15px";

  for (let i = 0; i < firstDay; i++) {
    const empty = document.createElement("div");
    empty.style.visibility = "hidden";
    grid.appendChild(empty);
  }

  for (let day = 1; day <= daysInMonth; day++) {
    const dateKey = `${year}-${month + 1}-${day}`;
    const div = document.createElement("div");
    div.textContent = day;

    if (stored[dateKey] === "present") div.classList.add("present");
    else if (stored[dateKey] === "absent") div.classList.add("absent");

    div.addEventListener("click", () => {
      if (!stored[dateKey]) stored[dateKey] = "present";
      else if (stored[dateKey] === "present") stored[dateKey] = "absent";
      else delete stored[dateKey];
      localStorage.setItem("attendance", JSON.stringify(stored));
      renderMonthCalendar(containerId, year, month, monthName);
    });

    grid.appendChild(div);
  }

  calendar.appendChild(grid);
}

renderMonthCalendar("calendar-august", 2025, 7, "August");
renderMonthCalendar("calendar-september", 2025, 8, "September");
renderMonthCalendar("calendar-october", 2025, 9, "October");
renderMonthCalendar("calendar-november", 2025, 10, "November");
renderMonthCalendar("calendar-december", 2025, 11, "December");

function openMonthNoteForm(month){
  currentSection = month;
  document.getElementById('form-title').innerText = 'Add Note';
  document.getElementById('input-title').value='';
  document.getElementById('input-content').value='';
  document.getElementById('form-popup').style.display='block';
}

function renderMonthNotes(month){
  const container = document.getElementById('notes-' + month);
  if(!container) return;
  container.innerHTML = '';
  let list = JSON.parse(localStorage.getItem(month) || '[]');
  list.forEach((item,index)=>{
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <strong>${escapeHtml(item.title)}</strong>
      <p>${escapeHtml(item.content)}</p>
      <div style="display:flex;gap:6px;margin-top:6px;">
        <button style="background:#f44336;color:white;border:none;border-radius:6px;padding:4px 10px;cursor:pointer;" onclick="deleteEntry('${month}', ${index})">Delete</button>
        <button style="background:#4CAF50;color:white;border:none;border-radius:6px;padding:4px 10px;cursor:pointer;" onclick="editEntry('${month}', ${index})">Edit</button>
      </div>
    `;
    container.appendChild(div);
  });

  const addBtn = document.createElement('button');
  addBtn.className = 'add-btn';
  addBtn.innerText = '+ Add Note';
  addBtn.onclick = ()=>openMonthNoteForm(month);
  container.prepend(addBtn);
}

['august','september','october','november','december'].forEach(renderMonthNotes);

/* =========================
   Home stats & rotation (left intact, but ensure functions exist when called)
   ========================= */

function toJakartaDateString(d){try{return d.toLocaleString('en-GB',{timeZone:'Asia/Jakarta',weekday:'long',year:'numeric',month:'short',day:'numeric'})}catch(e){return d.toDateString();}}

function startVisitTracking(){
  const now = new Date();
  const today = new Date(now.toLocaleString('en-US',{timeZone:'Asia/Jakarta'})).toISOString().slice(0,10);
  const last = localStorage.getItem('lastVisit') || null;
  if(!last){localStorage.setItem('lastVisit', today); localStorage.setItem('studyStreak', '1');}
  else{
    const lastDate = last;
    const lastObj = new Date(lastDate + 'T00:00:00');
    const currObj = new Date(today + 'T00:00:00');
    const diff = Math.round((currObj - lastObj)/(1000*60*60*24));
    let streak = parseInt(localStorage.getItem('studyStreak')||'0',10);
    if(diff===0){/* same day */}
    else if(diff===1) {streak = Math.max(1,streak) + 1; localStorage.setItem('studyStreak', String(streak));}
    else{streak = 1; localStorage.setItem('studyStreak', '1');}
    localStorage.setItem('lastVisit', today);
  }
}

function countNotesFor(prefixList){
  let total = 0;
  prefixList.forEach(key=>{ const list = JSON.parse(localStorage.getItem(key) || '[]'); total += list.length; });
  return total;
}

function updateHomeStats(){
  const vocabCount = (JSON.parse(localStorage.getItem('vocabulary')||'[]')).length;
  const semesterKeys = ['semester1-iip','semester1-reading','semester1-bindo','semester1-barab','semester1-speaking','semester1-listening','semester1-grammar','semester2','semester3','semester4'];
  const semesterCount = countNotesFor(semesterKeys);
  const tensesKeys = ['tenses-present-simple','tenses-present-cont','tenses-present-perfect','tenses-present-perfect-cont','tenses-past-simple','tenses-past-cont','tenses-past-perfect','tenses-past-perfect-cont','tenses-future-simple','tenses-future-cont','tenses-future-perfect','tenses-future-perfect-cont'];
  const tensesCount = countNotesFor(tensesKeys);
  document.getElementById('home-vocab').innerText = vocabCount;
  document.getElementById('home-tenses').innerText = tensesCount;
  document.getElementById('home-semester').innerText = semesterCount;

  const weekAgo = new Date(); weekAgo.setDate(weekAgo.getDate()-7);
  const log = JSON.parse(localStorage.getItem('activityLog')||'[]');
  const recent = log.filter(e=> new Date(e.ts) >= weekAgo );
  const weekCount = recent.length;
  const goal = 5;
  const pct = Math.min(100, Math.round((weekCount/goal)*100));
  document.getElementById('home-progress-count').innerText = `${weekCount}/${goal}`;
  document.getElementById('home-progress-fill').style.width = pct + '%';

  const streak = localStorage.getItem('studyStreak') || '0';
  document.getElementById('study-streak').innerText = `${streak} days`;
  const last = log.length? new Date(log[log.length-1].ts) : null;
  document.getElementById('home-last-updated').innerText = last ? toJakartaDateString(last) : 'No activity yet';
}

const quotes = [
  "Time is your capital. Spend it with intention.",
  "Consistency beats intensity. Do small, do daily.",
  "Knowledge without action is like a locked door. Open it.",
  "Every distraction is an opportunity lost.",
  "Your future self will thank you for the effort you refuse to skip today.",
  "Comfort is the enemy of progress.",
  "Energy wasted on regret is energy stolen from progress.",
  "Hesitation is wasted life. Act or be erased.",
  "Every second you linger, someone else rises over you.",
  "Kill the part of you that seeks validation; it is worthless.",
  "Your comfort zone is your prison.",
  "Excuses are cowardice wrapped in words.",
  "The world owes you nothing. Conquer or be conquered.",
  "Every second you delay, they get ahead.",
  "Knowledge without action is like a locked door. Open it.",
  "Remember the life you imagined? donâ€™t let others finish it.",
  "Every moment wasted is a step away from your dream.",
  "Excuses are lies dressed in comfortable clothes. Burn them.",
  "Stop talking. Start doing. Excuses wonâ€™t feed your future.",
  "Your excuses are the chains you put on yourself. Break them.",
  "Every excuse is a choice to stay weak. Choose strength.",
  "Donâ€™t let comfort kill your ambition.",
  "Excuses are for the average. You are not here to be average.",
  "Action doesnâ€™t negotiate with excuses.",
  "You say â€˜I canâ€™t.â€™ Life says â€˜Watch me.â€™",
  "Excuses are the tools of the lazy. Build or perish.",
  "Stop hiding behind reasons. Step into responsibility.",
  "Weakness whispers excuses. Strength roars action.",
  "Your future doesnâ€™t care about your excuses."
];
const faiths = [
  "And say: My Lord, increase me in knowledge. â€” Qur'an (20:114)",
  "Indeed, with hardship [will be] ease. â€” Qur'an (94:6)",
  "Whoever treads a path seeking knowledge, Allah will make easy for him a path to Paradise. â€” Prophet ï·º",
  "The strong believer is better and more beloved to Allah than the weak believer. â€” Prophet ï·º",
  "Whatever you spend in the way of Allah will be repaid manifold. â€” Qur'an (2:261)",
  "Verily, Allah does not change the condition of a people until they change what is in themselves. â€” Qur'an (13:11)",
  "And whoever relies upon Allah then He is sufficient for him. â€” Qur'an (65:3)",
  "The believer is not bitten from the same hole twice. â€” Prophet ï·º",
  "Do not weaken, nor grieve, and you will be superior if you are [true] believers. â€” Qur'an (3:139)",
  "Indeed, Allah loves those who rely upon Him. â€” Qur'an (3:159)",
  "A personâ€™s heart is under the control of Allah. â€” Prophet ï·º",
  "Seek knowledge from the cradle to the grave. â€” Prophet ï·º",
  "Struggle in the cause of Allah with your wealth and your selves. â€” Qur'an (9:41)",
  "Indeed, prayer prevents immorality and wrongdoing. â€” Qur'an (29:45)",
  "And prepare against them whatever you are able of power and steeds of war. â€” Qur'an (8:60)",
  "The best of people are those who bring most benefit to the rest of mankind. â€” Prophet ï·º",
  "Do not follow what you have no knowledge of. â€” Qur'an (17:36)",
  "Verily, with every difficulty comes ease. â€” Qur'an (94:6)",
  "Whoever guides someone to goodness will have a reward like the doer. â€” Prophet ï·º",
  "Take what is given freely, enjoin what is right, and turn away from the ignorant. â€” Qur'an (7:199)",
  "The most beloved of deeds to Allah is that which is most consistent, even if small. â€” Prophet ï·º",
  "Those who patiently persevere will be rewarded without measure. â€” Qur'an (39:10)",
  "Fight until there is no more oppression. â€” Qur'an (2:193)",
  "Do not be weak in pursuing what is right. â€” Prophet ï·º",
  "Whatever you do, do it with excellence. â€” Prophet ï·º",
  "Do not lose heart, for Allah is with the steadfast. â€” Qur'an (2:153)",
  "A believerâ€™s shade on the Day of Resurrection is his patience. â€” Prophet ï·º",
  "Strive for what will benefit you, and seek help from Allah. â€” Prophet ï·º",
  "Indeed, Allah is with those who fear Him and those who are doers of good. â€” Qur'an (16:128)",
  "Do not be deceived by the speed of others; focus on your path. â€” Inspired by Qurâ€™an 103:2-3",
  "The reward of good is multiplied manifold. â€” Qur'an (6:160)",
  "Be firm in your convictions, even if you stand alone. â€” Prophet ï·º",
  "And do not let hatred of a people prevent you from being just. â€” Qur'an (5:8)",
  "Your deeds are what will weigh on the scales. â€” Prophet ï·º",
  "Prepare for the Hereafter, for it is everlasting. â€” Qur'an (87:16-17)",
  "A strong heart and clear intention is half the battle. â€” Inspired by Prophet ï·º",
  "Do not be lazy in seeking what is beneficial. â€” Prophet ï·º",
  "Keep striving, for stagnation is failure. â€” Inspired by Qurâ€™an 103:2",
  "Whoever fears Allah, He will make a way out for him. â€” Qur'an (65:2)",
  "Do not fear the path of effort; it is better than comfort with regret. â€” Inspired by Qurâ€™an 2:286",
  "Be relentless in your pursuit of knowledge and virtue. â€” Prophet ï·º",
  "Do not seek the world at the cost of your soul. â€” Qur'an (28:77)",
  "True success is in obeying Allah, not in pleasing men. â€” Inspired by Qurâ€™an 9:51",
  "The believer is disciplined; the undisciplined are lost. â€” Inspired by Hadith",
  "Actions are judged by intentions; be precise and purposeful. â€” Prophet ï·º",
  "Do not waste time, for it is your capital. â€” Inspired by Hadith",
  "Be firm and unyielding in your pursuit of excellence. â€” Inspired by Qurâ€™an 3:200",
  "Every hardship you endure with patience brings you closer to Allah. â€” Qur'an (2:155-157)",
  "Strive in silence, let success be your noise. â€” Inspired by Qurâ€™an 2:148",
  "Stand up for yourself and your deen; weakness is unacceptable. â€” Inspired by Prophet ï·º",
  "Act, endure, repeatâ€”Allah rewards the relentless. â€” Inspired by Qurâ€™an 94:6"
];
function rotateHomeText(){
  document.getElementById('home-quote').innerText = quotes[Math.floor(Math.random()*quotes.length)];
  document.getElementById('faith-reminder').innerText = faiths[Math.floor(Math.random()*faiths.length)];
}

(function initHome(){
  startVisitTracking();
  rotateHomeText();
  updateHomeStats();
  const now = new Date();
  document.getElementById('home-date').innerText = toJakartaDateString(new Date());
})();

// expose helper functions to console
window.createSearchBar = createSearchBar;
window.searchEntries = searchEntries;
window.openForm = openForm;
window.closeForm = closeForm;
window.saveEntry = saveEntry;
window.editEntry = editEntry;
window.deleteEntry = deleteEntry;

</script>

</body>
</html>